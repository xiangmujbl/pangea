@pangea_test @AEAZ-8902
Feature:  OMPGdmTransport AEAZ-8902

  @Scenario
  Scenario: Full Load consumption /plan/cns_tlane_item_Exception

		# TEST AGAINST DEV
#		When I submit task with xml file "xml/omp/OMPGdmTransportException.xml" and execute file "jar/pangea-view.jar"
#		Then A file is found on sink application with name "GDMTransportMergeException.tsv"
#		When I submit task with xml file "xml/omp/OMPGdmTransport.xml" and execute file "jar/pangea-view.jar"
#		Then A file is found on sink application with name "GDMTransportMergeMain.tsv"
#		And I execute xd job to merge file "GDMTransportMerge*" to "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, requirementOffset, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"

		# TEST AGAINST LOCAL VM

    Given I import "/plan/cns_tlane_item_exception" by keyFields "sequenceNumber,tlaneName,materialNumber,mode"
      | sequenceNumber | tlaneName   | materialNumber | validFrom | validTo  | originLocation             | destinationLocation | mode | leadTime | deletionIndicator | processTypeId           |
      | 2              | CO02toPA01  | 55735          | 20180101  | 99991231 | CONS_LATAM_CO02            | CONS_LATAM_PA01     | Ship | 24       | X                 | InternalTransport       |
      | 2              | CO02toPA01  | 55735          | 20180101  | 99991231 | CONS_LATAM_CO02            | CONS_LATAM_PA01     | Air  | 7        |                   | InternalTransport       |
      | 19             | BR12toCO01  | 55755          | 20180101  | 99991231 | CONS_LATAM_BR12            | CONS_LATAM_CO01     | Ship | 33       | X                 | InternalTransport       |
      | 19             | BR12toCO01  | 55755          | 20180101  | 99991231 | CONS_LATAM_BR12            | CONS_LATAM_CO01     | Air  | 14       |                   | InternalTransport       |
      | 46             | 65659toUY01 | 57492          | 20180101  | 99991231 | CONS_LATAM_UY01$0000065659 | CONS_LATAM_UY01     | Ship | 14       | X                 | SubcontractingTransport |
      | 46             | 65659toUY01 | 57492          | 20180101  | 99991231 | CONS_LATAM_UY01$0000065659 | CONS_LATAM_UY01     | Air  | 7        |                   | SubcontractingTransport |
      | 800            | 19574toEC01 | 88732          | 20180101  | 99991231 | CONS_LATAM_V_0000019574    | CONS_LATAM_EC01     | Ship | 63       | X                 | VendorTransport         |
      | 800            | 19574toEC01 | 88732          | 20180101  | 99991231 | CONS_LATAM_V_0000019574    | CONS_LATAM_EC01     | Air  | 14       |                   | VendorTransport         |

    And I wait "/plan/cns_tlane_item_exception" Async Queue complete

    Given I import "/plan/cns_tlane_item" by keyFields "sequenceNumber,tlaneName,materialNumber,mode"
      | sequenceNumber | tlaneName   | materialNumber | validFrom | validTo  | originLocation             | destinationLocation     | mode  | leadTime | processTypeId           |
      | 18             | BR12toBR07  | 58722          | 20180101  | 29981231 | CONS_LATAM_BR12            | CONS_LATAM_BR07         | Truck | 17       | InternalTransport       |
      | 17             | BR12toBR16  | 58722          | 20180101  | 29981231 | CONS_LATAM_BR12            | CONS_LATAM_BR16         | Truck | 2        | InternalTransport       |
      | 43             | 12398toCO01 | 97360          | 20180101  | 29981231 | CONS_LATAM_CO01$0000012398 | CONS_LATAM_CO01         | Ship  | 33       | SubcontractingTransport |
      | 119            | 50161toCL01 | 60520          | 20180101  | 29981231 | CONS_LATAM_V_0000050161    | CONS_LATAM_CL01         | Ship  | 42       | VendorTransport         |
      # b
      | 2              | CO02toPA01  | 55735          | 20180101  | 29981231 | CONS_LATAM_CO01            | CONS_LATAM_PA01         | Ship  | 24       | InternalTransport       |

      | 19             | BR12toCO01  | 55755          | 20180101  | 29991231 | CONS_LATAM_BR12            | CONS_LATAM_CO01         | Ship  | 24       | InternalTransport       |
      | 32             | BR12toBR07  | 58722          | 20180101  | 29981231 | CONS_LATAM_BR12            | CONS_LATAM_V_0000050161 | Truck | 17       | InternalTransport       |

    And I wait "/plan/cns_tlane_item" Async Queue complete

    Given I import "/plan/cns_process_type" by keyFields "processTypeId"
      | processTypeId           | processTypeDesc                                                                                                                                 |
      | InternalTransport       | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP)                     |
      | VendorTransport         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                                         |
      | SubcontractingTransport | Subcontracting Transport (Transport to ship components to a subcontractor)                                                                      |
      | Subcontracting          | Subcontracting                                        LocalVendorAccountNumber                                                                  |
      | ExternalPurchase        | External Purchase                                                                                                                               |
      | VendorPurchase          | Vendor Purchase                                                                                                                                 |
      | InterERPTransport       | InterERP Transport (Transport between 2 different ERP systems, modeled through sales order/purchase order)                                      |
      | Production              | Production                                                                                                                                      |
      | ExternalTransport       | External Transport (Transport from 1 fiscal entity to another fiscal entity in the same ERP system, modeled through sales order/purchase order) |

    And I wait "/plan/cns_process_type" Async Queue complete

    Given I import "/edm/material_plant_v1" by keyFields "localMaterialNumber,localPlant,sourceSystem"
      | purchsngGrpCd | sourceSystem | localMaterialNumber | localPlant | localMaximumLotSize | localMaximumStockLevel | localMinimumLotSize | localMinimumSafetyStock | localMrpController | localMrpType | localPlannedDeliveryTimeInDays | localPlanningStrategyGroup | localPlanningTimeFence | localPlantStatus | localPostToInspStk | localPostToInspectionStock | localProcurementType | localProductionSupervisor | localProductionUnit | localRoundingValueForPoq | localSafetyStock | localSafetyTime | localSafetyTimeIndicator | localSpecialProcurementType | materialNumber | plant | localAbcIndicator | localBaseQuantity | localBatchManagementRequirementIndicator | localCheckingGroupForAvailabilityCheck | localComponentScrap | localComponentScrapInPercent | localConsumptionMode | localConsumptionPeriodBackward | localConsumptionPeriodForward | localCriticalPart | localDeletionFlagPlant | localDependentRequirements | localFixedLotSize | localGoodsReceiptProcessingTimeInDays | localInHouseProcessingTime | localLotSize |
      |               | CONS_LATAM   | 55735               | PA01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      |                  |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR02                   |                            | 0                 | 0                                     | 0                          |              |
      | PRD           | CONS_LATAM   | 55755               | CO01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR21                   |                            | 0                 | 0                                     | 0                          |              |
      | A17           | CONS_LATAM   | 60520               | CL01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   | AR03                   |                            | 0                 | 0                                     | 0                          |              |
      | A18           | CONS_LATAM   | 60520               | BR12       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR08                   |                            | 0                 | 0                                     | 0                          |              |
      | B30           | CONS_LATAM   | 57492               | UY01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                | UY01  |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | UY01                   |                            | 0                 | 0                                     | 0                          |              |
      | B31           | CONS_LATAM   | 88732               | EC01       | 0                   | 0                      | 3870                | 0                       | 61                 | PD           | 15                             | 10                         | 0                      | 8                |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |                | EC01  |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   | EC01                   | 2                          | 0                 | 0                                     | 1                          | EX           |
      | B32           | CONS_LATAM   | 58722               | BR07       | 0                   | 0                      | 3870                | 0                       | 61                 | PD           | 15                             | 10                         | 0                      | 8                |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |                | BR59  |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   | BR12                   | 2                          | 0                 | 0                                     | 1                          | EX           |

    And I wait "/edm/material_plant_v1" Async Queue complete

    Given I import "/edm/material_global_v1" by keyFields "sourceSystem,localMaterialNumber"
      | MaterialNumber | SourceSystem | _test_reservation_ | baseUom | baseuom | batchManageIndicator | batchmanageindicator | brand | category | division | flagForDeletion | flagfordeletion | form | franchise | getPrimaryPlanningCode | globalBusinessUnit | globalDpParentCode | globalbusinessunit | globaldpparentcode | localBaseUom | localDpParentCode | localManufacturingTechnology | localMaterialGroup | localMaterialNumber | localMaterialType | localRefDescription                   | localbaseuom | localdpparentcode | localmanufacturingtechnology | localmaterialgroup | localmaterialnumber | localmaterialtype | localrefdescription | manufacturingTechnology | manufacturingtechnology | materialGroup | materialNumber | materialStatus | materialType | materialgroup | materialnumber | materialstatus | materialtype | minRemShelfLife | minremshelflife | parentCode | parentcode | primaryPlanningCode | primaryplanningcode | productFamily | productfamily | refDescription                      | refdescription | sourceSystem | sourceSystem25 | sourcesystem | subBrand | subbrand | testReservation | totalShelfLife | totalshelflife |
      |                |              |                    | CA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | CS           |                   |                              | 1                  | 55755               | FERT              | B-AID BRAND ADHESIVE B CLEAR FOUND    |              |                   |                              |                    |                     |                   |                     |                         |                         |               |                | 8              | FERT         |               |                |                |              | 180             |                 |            |            | 55755               |                     |               |               | B-AID BRAND ADHESIVE B CLEAR FOUND  |                | CONS_LATAM   |                |              |          |          |                 | 9999           |                |
      |                |              |                    | EA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | EA           |                   |                              | 1                  | 55735               | FERT              | LISTERINE PRO ENCIAS 12X250ML         |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 55735          | 8              | FERT         |               |                |                |              | 220             |                 |            |            | 55735               |                     |               |               | LISTERINE PRO ENCIAS 12X250ML       |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |
      |                |              |                    | EA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | EA           |                   |                              | 1                  | 57492               | FERT              | J BABY SHAMPOO ORIGIN NUEVO 12X750    |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 57492          | 8              | FERT         |               |                |                |              | 180             |                 |            |            | 57492               |                     |               |               | J BABY SHAMPOO ORIGIN NUEVO 12X750  |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |
      |                |              |                    | EA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | EA           |                   |                              | 1                  | 88732               | FERT              | CAREFREE MULTIFLEXIÃ¯Â¿Â½ BRISA 24X60 |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 88732          | 8              | FERT         |               |                |                |              | 180             |                 |            |            | 88732               |                     |               |               | CAREFREE MULTIFLEXIÃ‚Â  BRISA 24X60 |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |

    And I wait "/edm/material_global_v1" Async Queue complete

    Given I import "/edm/source_list_v1" by keyFields "sourceSystem,localMaterialNumber,localPlant,localNumberofSourceListRecord"
      | localVendorAccountNumber | localMaterialNumber | localPlant | localPlantfromWhichMaterialisProcured | localPurchasingDocumentCategory | localPurchasingOrganization | localSourceListRecordValidFrom | localSourceListRecordValidTo | localSourceListUsageinMaterialsPlanning | sourceSystem | _test_reservation_ | localAgreementItem | localAgreementNumber | localBlockedSourceofSupply | localCategoryofSourceListRecord | localDateonWhichRecordWasCreated | localFixedOutlinePurchaseAgreementItem | localFixedvendor | localMaterialNumberCorrespondingtoManufacturerPartNumber | localNameofPersonwhoCreatedtheObject | localNumberofSourceListRecord |
      | 65659                    | 57492               | UY01       |                                       | K                               | UY00                        | 20180525                       | 99991230                     | 1                                       | CONS_LATAM   |                    | 17160              | 5100006016           |                            | 0                               | 20180525                         | X                                      |                  |                                                          | LCASTI16                             | 1                             |
      | 65659                    | 57492               | UY01       |                                       | K                               | UY00                        | 20150430                       | 99991230                     | 1                                       | CONS_LATAM   |                    | 16290              | 5100006270           |                            | 0                               | 20150430                         | X                                      |                  |                                                          | DNASCIM                              | 1                             |
      | 19574                    | 88732               | EC01       |                                       |                                 | EC00                        | 20160509                       | 99991230                     |                                         | CONS_LATAM   |                    | 0                  |                      |                            | 0                               | 20160509                         |                                        |                  |                                                          | RPULCINO                             | 2                             |
      | 8917                     | 55755               | CO01       | BR12                                  | K                               | CO00                        | 20050101                       | 99991231                     | 1                                       | CONS_LATAM   |                    | 4420               | 5100001959           |                            | 0                               | 20050622                         | X                                      |                  |                                                          | JSARKISS                             | 1                             |
      | 8917                     | 55755               | CO01       |                                       |                                 | CO00                        | 20151202                       | 99991230                     |                                         | CONS_LATAM   |                    | 0                  |                      |                            | 7                               | 20151202                         |                                        |                  |                                                          | WREIS                                | 12                            |
      | 4676                     | 55735               | PA01       |                                       | K                               | PA00                        | 20070101                       | 99991231                     | 1                                       | CONS_LATAM   |                    | 7690               | 5100003102           |                            | 0                               | 20070329                         | X                                      |                  |                                                          | RLEITAO                              | 1                             |

    And I wait "/edm/source_list_v1" Async Queue complete

    Given I import "/plan/cns_spl_pln_loc" by keyFields "sourceSystem,localNumber,localName,vendorOrCustomer"
#      | localCountry | localCurrency | localName                       | localNumber | localPlant | localRegion | pLanlocTypeDesc | pLanlocTypeId | planLocTypeDesc           | planLocTypeId | sourceSystem | vendorOrCustomer | specLocAtt1 | _1specLocAtt | _1specLocAttDesc | _2specLocAtt | _2specLocAttDesc | _2specLocAttdEsc | _3specLocAtt | _3specLocAttDesc | specLocAtt2 | specLocAtt3 | specLocAttDesc1 | specLocAttDesc2 | specLocAttDesc3 | vendororCustomer |
#      | CO           | USE           | LODISAL S.A.                    | 0000012398  | CO01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |
#      | CL           | CRC           | D.H.L. COSTA RICA (CORMAR) S.A. | 0000050161  | CL01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |
#      | UY           | USE           | LODISAL S.A.                    | 0000065659  | UY01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |
#      | EC           | CRC           | D.H.L. COSTA RICA (CORMAR) S.A. | 0000019574  | EC01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |
      | localCountry | localCurrency | localName                       | localNumber | localPlant | localRegion | pLanlocTypeDesc | pLanlocTypeId | planLocTypeDesc           | planLocTypeId | sourceSystem | vendorOrCustomer | specLocAtt1 | _1specLocAtt | _1specLocAttDesc | _2specLocAtt | _2specLocAttDesc | _2specLocAttdEsc | _3specLocAtt | _3specLocAttDesc | specLocAtt2 | specLocAtt3 | specLocAttDesc1 | specLocAttDesc2 | specLocAttDesc3 | vendororCustomer |
      | UY           | USE           | LODISAL S.A.                    | 0000065659  | UY01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |
      | EC           | CRC           | D.H.L. COSTA RICA (CORMAR) S.A. | 0000019574  | EC01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |



    And I wait "/plan/cns_spl_pln_loc" Async Queue complete

    Given I import "/plan/cns_material_plan_status" by keyFields "sourceSystem,localMaterialNumber,localPlant"
      | localMaterialNumber | sourceSystem | localPlant | active | dpRelevant | localParentCode    | materialNumber | noPlanRelevant | parentActive | ppc   | spRelevant |
      | 55735               | CONS_LATAM   | PA01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |

      | 55735               | CONS_LATAM   | UY01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 55735               | CONS_LATAM   | CO01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 55744               | CONS_LATAM   | 0000019574 | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 88732               | CONS_LATAM   | EC01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 55755               | CONS_LATAM   | BR12       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |


      | 55755               | CONS_LATAM   | BR12       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 55755               | CONS_LATAM   | CO01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |

      | 57492               | CONS_LATAM   | UY01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 88732               | CONS_LATAM   | 0000019574 | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |
      | 55735               | CONS_LATAM   | CO02       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |


    And I wait "/plan/cns_material_plan_status" Async Queue complete


    Given I import "/edm/plant_v1" by keyFields "sourceSystem,localPlant"
      | country | localCountry | localCurrency | localPlanningRelevant | localPlant | localPlantName                  | localPlantType | plant | plantType               | region                                    | site                 | sourceSystem |
      | MX      | MX           | MXN           | X                     | CL01       | Sales & Marketing               | DC             | CL01  | DC, Distribution Center | MX, MEXICO MEXICO                         | Importadora DC       | CONS_LATAM   |
      | VE      | VE           | VEF           | X                     | EC01       | J&J VE-Valencia-DistribuiciÃ³n  | DC             | VE02  | DC, Distribution Center | VE, VENEZUELA VENEZUELA                   | Valencia DC          | CONS_LATAM   |
      | GT      | GT           | GTQ           | X                     | GT02       | J&J Guatemala - Bond Fiscal     | DC             | GT02  | DC, Distribution Center | GT, GUATEMALA GUATEMALA                   | Guatemala BF DC      | CONS_LATAM   |
      | AR      | AR           | ARS           | X                     | AR01       | Pilar Plant                     | DC             | AR01  | MP, Manufacturing Plant | AR, ARGENTINA ARGENTINA                   | Pilar                | CONS_LATAM   |
      | DO      | DO           | DOP           | X                     | DO01       | J&J DO-S.Domingos 1-R.Dominica  | DC             | DO01  | DC, Distribution Center | DO, DOMINICAN REPUBLIC DOMINICAL REPUBLIC | Dominica             | CONS_LATAM   |
      | CO      | CO           | BRL           | X                     | CO01       | J&J Colombia - LADS (CO01)      | DC             | CO01  | MP, Manufacturing Plant | CO, COLOMBIA COLOMBIA                     | Cali                 | CONS_LATAM   |
      | VE      | VE           | VEF           | X                     | BR16       | J&J VE-Valencia-ETHNOR          |                | BR16  | DC, Distribution Center | VE, VENEZUELA VENEZUELA                   | Valencia Ethnor DC   | CONS_LATAM   |
      | AR      | AR           | ARS           | X                     | UY01       | S & M Pilar                     | DC             | AR02  | DC, Distribution Center | AR, ARGENTINA ARGENTINA                   | Pilar DC             | CONS_LATAM   |
      | PA      | PA           | PAB           | X                     | PA01       | J&J Panama - Zona Libre         | DC             | PA01  | DC, Distribution Center | PA, PANAMA PANAMA                         | Panama Zona Libre DC | CONS_LATAM   |
      | BR      | BR           | BRL           | X                     | BR07       | J&J BR-JoÃ£o Pessoa-COM&Distrib | DC             | BR07  | DC, Distribution Center | BR, BRAZIL BRAZIL                         | Pessoa DC            | CONS_LATAM   |


      | BR      | BR           | BRL           | X                     | BR12       | J&J BR-JoÃ£o Pessoa-COM&Distrib | DC             | BR07  | DC, Distribution Center | BR, BRAZIL BRAZIL                         | Pessoa DC            | CONS_LATAM   |
      | CO      | CO           | BRL           | X                     | CO02       | J&J Colombia - LADS (CO01)      | DC             | CO02  | MP, Manufacturing Plant | CO, COLOMBIA COLOMBIA                     | Cali                 | CONS_LATAM   |

    And I wait "/edm/plant_v1" Async Queue complete


    And I will remove the test file on sink application "GDMTransportMergeException.tsv"

    When I submit task with xml file "xml/omp/OMPGdmTransportException.xml" and execute file "jar/pangea-view.jar"

    Then A file is found on sink application with name "GDMTransportMergeException.tsv"

    And I check file data for filename "GDMTransportMergeException.tsv" by keyFields "transportId"
    #Then I check region data "/omp/gdm_transport" by keyFields "transportId"
      | transportId                                 | active | activeOPRERP | activeSOPERP | endEff              | fromLocationId        | fromProductId | label                                                                                                                       | machineTypeId | minQuantity | planLevelId | processTypeId           | purchasingGroup | purchasingOrganization | startEff            | toLocationId    | toProductId | transportOffset | transportType | vendorId |
      | 55755/CONS_LATAM_BR12/CONS_LATAM_CO01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_BR12       | 55755         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | PRD             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01 | 55755       | 14              | Air           | 8917     |
      | 57492/CONS_LATAM_UY01$65659/CONS_LATAM_UY01 | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_UY01$65659 | 57492         | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | TRANSPORT     | 0.0         | *           | SubcontractingTransport | B30             | UY00                   | 2018/01/01 00:00:00 | CONS_LATAM_UY01 | 57492       | 7               | Air           | 65659    |
      | 88732/CONS_LATAM_V_19574/CONS_LATAM_EC01    | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_V_19574    | 88732         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | TRANSPORT     | 0.0         | *           | VendorTransport         | B31             | EC00                   | 2018/01/01 00:00:00 | CONS_LATAM_EC01 | 88732       | 14              | Air           | 19574    |
      | 55735/CONS_LATAM_CO02/CONS_LATAM_PA01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_CO02       | 55735         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | PA00                   | 2018/01/01 00:00:00 | CONS_LATAM_PA01 | 55735       | 7               | Air           | 4676     |

#
#    And I execute xd job to merge file "GDMTransportMerge*" to "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, requirementOffset, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"
#
#    And I check file data for filename "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, requirementOffset, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"
#
#
#      | transportId                                 | active | activeOPRERP | activeSOPERP | endEff              | fromLocationId        | fromProductId | label                                                                                                                       | machineTypeId | minQuantity | planLevelId | processTypeId           | purchasingGroup | purchasingOrganization | startEff            | toLocationId       | toProductId | transportOffset | transportType | vendorId | requirementOffset |
#      | 55735/CONS_LATAM_CO01/CONS_LATAM_PA01       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_CO01       | 55735         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | PA00                   | 2018/01/01 00:00:00 | CONS_LATAM_PA01    | 55735       | 24              | Ship          | 4676     |                   |
#
#      | 55755/CONS_LATAM_BR12/CONS_LATAM_CO01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_BR12       | 55755         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | PRD             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01    | 55755       | 24              | Ship          | 8917     |                   |
#      | 97360/CONS_LATAM_CO01$12398/CONS_LATAM_CO01 | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_CO01$12398 | 97360         | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | TRANSPORT     | 0.0         | *           | SubcontractingTransport | B30             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01    | 97360       | 33              | Ship          | 8917     |                   |
#      | 60520/CONS_LATAM_V_50161/CONS_LATAM_CL01    | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_V_50161    | 60520         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | TRANSPORT     | 0.0         | *           | VendorTransport         | A17             | CL00                   | 2018/01/01 00:00:00 | CONS_LATAM_CL01    | 60520       | 42              | Ship          | 50161    |                   |
#      | 58722/CONS_LATAM_BR12/CONS_LATAM_BR07       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | B32             | BR00                   | 2018/01/01 00:00:00 | CONS_LATAM_BR07    | 58722       | 17              | Truck         | 99999    |                   |
#      | 58722/CONS_LATAM_BR12/CONS_LATAM_BR16       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | B31             |                        | 2018/01/01 00:00:00 | CONS_LATAM_BR16    | 58722       | 2               | Truck         |          |                   |
#      | 58722/CONS_LATAM_BR12/CONS_LATAM_V_50161    | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 |                        | 2018/01/01 00:00:00 | CONS_LATAM_V_50161 | 58722       | 17              | Truck         |          |                   |
#
#      | 55755/CONS_LATAM_BR12/CONS_LATAM_CO01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_BR12       | 55755         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | PRD             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01    | 55755       | 14              | Air           | 8917     |                   |
#      | 57492/CONS_LATAM_UY01$65659/CONS_LATAM_UY01 | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_UY01$65659 | 57492         | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | TRANSPORT     | 0.0         | *           | SubcontractingTransport | B30             | UY00                   | 2018/01/01 00:00:00 | CONS_LATAM_UY01    | 57492       | 7               | Air           | 65659    |                   |
#      | 88732/CONS_LATAM_V_19574/CONS_LATAM_EC01    | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_V_19574    | 88732         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | TRANSPORT     | 0.0         | *           | VendorTransport         | B31             | EC00                   | 2018/01/01 00:00:00 | CONS_LATAM_EC01    | 88732       | 14              | Air           | 19574    |                   |
#      | 55735/CONS_LATAM_CO01/CONS_LATAM_PA01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_CO01       | 55735         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | PA00                   | 2018/01/01 00:00:00 | CONS_LATAM_PA01    | 55735       | 7               | Air           | 4676     |                   |



    And I will remove all data with region "/omp/gdm_transport"
    And I will remove all data with region "/plan/cns_tlane_item"
    And I will remove all data with region "/plan/cns_tlane_item_exception"
    And I will remove all data with region "/plan/cns_process_type"
    And I will remove all data with region "/plan/cns_material_plan_status"
    And I will remove all data with region "/plan/cns_spl_pln_loc"
    And I will remove all data with region "/edm/plant_v1"
    And I will remove all data with region "/edm/source_list_v1"
    And I will remove all data with region "/edm/material_global_v1"
    And I will remove all data with region "/edm/material_plant_v1"


  @Scenario1
  Scenario: Full Load consumption /plan/cns_tlane_item

		# TEST AGAINST DEV
#		When I submit task with xml file "xml/omp/OMPGdmTransportException.xml" and execute file "jar/pangea-view.jar"
#		Then A file is found on sink application with name "GDMTransportMergeException.tsv"
#		When I submit task with xml file "xml/omp/OMPGdmTransport.xml" and execute file "jar/pangea-view.jar"
#		Then A file is found on sink application with name "GDMTransportMergeMain.tsv"
#		And I execute xd job to merge file "GDMTransportMerge*" to "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, requirementOffset, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"

		# TEST AGAINST LOCAL VM
    Given I import "/plan/cns_tlane_item_exception" by keyFields "sequenceNumber,tlaneName,materialNumber"
      | sequenceNumber | tlaneName  | materialNumber | validFrom | validTo  | originLocation  | destinationLocation | mode | leadTime | deletionIndicator | processTypeId     |
      | 2              | CO02toPA01 | 55735          | 20180101  | 99991231 | CONS_LATAM_CO02 | CONS_LATAM_PA01     | Ship | 24       | X                 | InternalTransport |
      | 2              | CO02toPA01 | 55735          | 20180101  | 99991231 | CONS_LATAM_CO02 | CONS_LATAM_PA01     | Air  | 7        |                   | InternalTransport |

    And I wait "/plan/cns_tlane_item_exception" Async Queue complete

    Given I import "/plan/cns_tlane_item" by keyFields "sequenceNumber,tlaneName,materialNumber"
      | sequenceNumber | tlaneName   | materialNumber | validFrom | validTo  | originLocation             | destinationLocation | mode  | leadTime | processTypeId           |
      | 18             | BR12toBR07  | 58722          | 20180101  | 29981231 | CONS_LATAM_BR12            | CONS_LATAM_BR07     | Truck | 17       | InternalTransport       |
      | 17             | BR12toBR16  | 58722          | 20180101  | 29981231 | CONS_LATAM_BR12            | CONS_LATAM_BR16     | Truck | 2        | InternalTransport       |
      | 43             | 12398toCO01 | 97360          | 20180101  | 29981231 | CONS_LATAM_CO01$0000012398 | CONS_LATAM_CO01     | Ship  | 33       | SubcontractingTransport |
      | 119            | 50161toCL01 | 60520          | 20180101  | 29981231 | CONS_LATAM_V_0000050161    | CONS_LATAM_CL01     | Ship  | 42       | VendorTransport         |
      | 2              | CO02toPA01  | 55735          | 20180101  | 29981231 | CONS_LATAM_CO02            | CONS_LATAM_PA01     | Ship  | 24       | InternalTransport       |
      | 19             | BR12toCO01  | 55755          | 20180101  | 29991231 | CONS_LATAM_BR12            | CONS_LATAM_CO01     | Ship  | 24       | InternalTransport       |

    And I wait "/plan/cns_tlane_item" Async Queue complete

    Given I import "/plan/cns_process_type" by keyFields "processTypeId"
      | processTypeId           | processTypeDesc                                                                                                                                 |
      | InternalTransport       | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP)                     |
      | VendorTransport         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                                         |
      | SubcontractingTransport | Subcontracting Transport (Transport to ship components to a subcontractor)                                                                      |
      | Subcontracting          | Subcontracting                                        LocalVendorAccountNumber                                                                  |
      | ExternalPurchase        | External Purchase                                                                                                                               |
      | VendorPurchase          | Vendor Purchase                                                                                                                                 |
      | InterERPTransport       | InterERP Transport (Transport between 2 different ERP systems, modeled through sales order/purchase order)                                      |
      | Production              | Production                                                                                                                                      |
      | ExternalTransport       | External Transport (Transport from 1 fiscal entity to another fiscal entity in the same ERP system, modeled through sales order/purchase order) |

    And I wait "/plan/cns_process_type" Async Queue complete

    Given I import "/edm/material_plant_v1" by keyFields "localMaterialNumber,localPlant,sourceSystem"
      | purchsngGrpCd | sourceSystem | localMaterialNumber | localPlant | localMaximumLotSize | localMaximumStockLevel | localMinimumLotSize | localMinimumSafetyStock | localMrpController | localMrpType | localPlannedDeliveryTimeInDays | localPlanningStrategyGroup | localPlanningTimeFence | localPlantStatus | localPostToInspStk | localPostToInspectionStock | localProcurementType | localProductionSupervisor | localProductionUnit | localRoundingValueForPoq | localSafetyStock | localSafetyTime | localSafetyTimeIndicator | localSpecialProcurementType | materialNumber | plant | localAbcIndicator | localBaseQuantity | localBatchManagementRequirementIndicator | localCheckingGroupForAvailabilityCheck | localComponentScrap | localComponentScrapInPercent | localConsumptionMode | localConsumptionPeriodBackward | localConsumptionPeriodForward | localCriticalPart | localDeletionFlagPlant | localDependentRequirements | localFixedLotSize | localGoodsReceiptProcessingTimeInDays | localInHouseProcessingTime | localLotSize |
      |               | CONS_LATAM   | 55735               | PA01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      |                  |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR02                   |                            | 0                 | 0                                     | 0                          |              |
      |               | CONS_LATAM   | 55755               | CO01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR21                   |                            | 0                 | 0                                     | 0                          |              |
      | A17           | CONS_LATAM   | 60520               | CL01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   | AR03                   |                            | 0                 | 0                                     | 0                          |              |
      | A18           | CONS_LATAM   | 60520               | BR12       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                |       |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR08                   |                            | 0                 | 0                                     | 0                          |              |
      | B30           | CONS_LATAM   | 97360               | CO01       | 0                   | 0                      | 0                   | 0                       |                    |              | 0                              |                            | 0                      | 8                |                    |                            |                      |                           |                     | 0                        | 0                | 0               |                          |                             |                | BR69  |                   | 0                 |                                          |                                        | 0                   | 0                            |                      | 0                              | 0                             |                   | BR25                   |                            | 0                 | 0                                     | 0                          |              |
      | B31           | CONS_LATAM   | 58722               | BR16       | 0                   | 0                      | 3870                | 0                       | 61                 | PD           | 15                             | 10                         | 0                      | 8                |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |                | BR59  |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   | BR12                   | 2                          | 0                 | 0                                     | 1                          | EX           |
      | B32           | CONS_LATAM   | 58722               | BR07       | 0                   | 0                      | 3870                | 0                       | 61                 | PD           | 15                             | 10                         | 0                      | 8                |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |                | BR59  |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   | BR12                   | 2                          | 0                 | 0                                     | 1                          | EX           |

    And I wait "/edm/material_plant_v1" Async Queue complete

    Given I import "/edm/material_global_v1" by keyFields "sourceSystem,localMaterialNumber"
      | MaterialNumber | SourceSystem | _test_reservation_ | baseUom | baseuom | batchManageIndicator | batchmanageindicator | brand | category | division | flagForDeletion | flagfordeletion | form | franchise | getPrimaryPlanningCode | globalBusinessUnit | globalDpParentCode | globalbusinessunit | globaldpparentcode | localBaseUom | localDpParentCode | localManufacturingTechnology | localMaterialGroup | localMaterialNumber | localMaterialType | localRefDescription                   | localbaseuom | localdpparentcode | localmanufacturingtechnology | localmaterialgroup | localmaterialnumber | localmaterialtype | localrefdescription | manufacturingTechnology | manufacturingtechnology | materialGroup | materialNumber | materialStatus | materialType | materialgroup | materialnumber | materialstatus | materialtype | minRemShelfLife | minremshelflife | parentCode | parentcode | primaryPlanningCode | primaryplanningcode | productFamily | productfamily | refDescription                      | refdescription | sourceSystem | sourceSystem25 | sourcesystem | subBrand | subbrand | testReservation | totalShelfLife | totalshelflife |
      |                |              |                    | CA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | CS           |                   |                              | 1                  | 58722               | FERT              | B-AID BRAND ADHESIVE B CLEAR FOUND    |              |                   |                              |                    |                     |                   |                     |                         |                         |               |                | 8              | FERT         |               |                |                |              | 180             |                 |            |            | 58722               |                     |               |               | B-AID BRAND ADHESIVE B CLEAR FOUND  |                | CONS_LATAM   |                |              |          |          |                 | 9999           |                |
      |                |              |                    | EA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | EA           |                   |                              | 1                  | 55735               | FERT              | LISTERINE PRO ENCIAS 12X250ML         |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 55735          | 8              | FERT         |               |                |                |              | 220             |                 |            |            |                     |                     |               |               | LISTERINE PRO ENCIAS 12X250ML       |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |
      |                |              |                    | EA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | EA           |                   |                              | 1                  | 97360               | FERT              | J BABY SHAMPOO ORIGIN NUEVO 12X750    |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 97360          | 8              | FERT         |               |                |                |              | 180             |                 |            |            |                     |                     |               |               | J BABY SHAMPOO ORIGIN NUEVO 12X750  |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |
      |                |              |                    | EA      |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | EA           |                   |                              | 1                  | 60520               | FERT              | CAREFREE MULTIFLEXIÃ¯Â¿Â½ BRISA 24X60 |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 60520          | 8              | FERT         |               |                |                |              | 180             |                 |            |            | 60520               |                     |               |               | CAREFREE MULTIFLEXIÃ‚Â  BRISA 24X60 |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |
      |                |              |                    | CRT     |         | X                    |                      |       |          | 10       |                 |                 |      |           |                        |                    |                    |                    |                    | KI           |                   |                              | 1                  | 55755               | SAPR              | NEUT D CLEAN LIMP FACIAL  240X5G AG   |              |                   |                              |                    |                     |                   |                     |                         |                         |               | 55755          | 8              | FERT         |               |                |                |              | 183             |                 |            |            | 55755               |                     |               |               | NEUT D CLEAN LIMP FACIAL  240X5G AG |                | CONS_LATAM   |                |              |          |          |                 | 730            |                |

    And I wait "/edm/material_global_v1" Async Queue complete

    Given I import "/edm/source_list_v1" by keyFields "sourceSystem,localMaterialNumber,localPlant,localNumberofSourceListRecord"
      | localVendorAccountNumber | localMaterialNumber | localPlant | localPlantfromWhichMaterialisProcured | localPurchasingDocumentCategory | localPurchasingOrganization | localSourceListRecordValidFrom | localSourceListRecordValidTo | localSourceListUsageinMaterialsPlanning | sourceSystem | _test_reservation_ | localAgreementItem | localAgreementNumber | localBlockedSourceofSupply | localCategoryofSourceListRecord | localDateonWhichRecordWasCreated | localFixedOutlinePurchaseAgreementItem | localFixedvendor | localMaterialNumberCorrespondingtoManufacturerPartNumber | localNameofPersonwhoCreatedtheObject | localNumberofSourceListRecord |
      | 8917                     | 58722               | BR07       |                                       | K                               | BR00                        | 20180525                       | 99991230                     | 1                                       | CONS_LATAM   |                    | 17160              | 5100006016           |                            | 0                               | 20180525                         | X                                      |                  |                                                          | LCASTI16                             | 1                             |
      | 4676                     | 58722               |            |                                       | K                               | BR00                        | 20150430                       | 99991230                     | 1                                       | CONS_LATAM   |                    | 16290              | 5100006270           |                            | 0                               | 20150430                         | X                                      |                  |                                                          | DNASCIM                              | 1                             |
      | 12398                    | 97360               | CO01       |                                       |                                 | CO00                        | 20160509                       | 99991230                     |                                         | CONS_LATAM   |                    | 0                  |                      |                            | 0                               | 20160509                         |                                        |                  |                                                          | RPULCINO                             | 2                             |
      | 4676                     | 60520               | BR12       |                                       | K                               | BR00                        | 20050101                       | 99991231                     | 1                                       | CONS_LATAM   |                    | 4420               | 5100001959           |                            | 0                               | 20050622                         | X                                      |                  |                                                          | JSARKISS                             | 1                             |
      | 50161                    | 60520               | CL01       |                                       |                                 | CL00                        | 20151202                       | 99991230                     |                                         | CONS_LATAM   |                    | 0                  |                      |                            | 7                               | 20151202                         |                                        |                  |                                                          | WREIS                                | 12                            |
      | 4676                     | 55735               | PA01       |                                       | K                               | AR00                        | 20070101                       | 99991231                     | 1                                       | CONS_LATAM   |                    | 7690               | 5100003102           |                            | 0                               | 20070329                         | X                                      |                  |                                                          | RLEITAO                              | 1                             |
      | 42221                    | 55755               | CO01       |                                       |                                 | CO00                        | 20150504                       | 99991230                     |                                         | CONS_LATAM   |                    | 0                  |                      |                            | 0                               | 20150505                         |                                        |                  |                                                          | MMONTE14                             | 2                             |
      | 99999                    | 58722               | BR07       | BR12                                  | K                               | BR00                        | 20101115                       | 99991230                     | 1                                       | CONS_LATAM   |                    | 360                | 5100004171           |                            | 0                               | 20101215                         | X                                      |                  |                                                          | RPULCINO                             | 1                             |
      | 3531                     | 58722               | BR07       |                                       |                                 | BR00                        | 20000101                       | 99991231                     |                                         | CONS_LATAM   |                    | 0                  |                      |                            | 0                               | 20000906                         |                                        |                  |                                                          | BASISBTC                             | 2                             |
      | 12398                    | 97360               | CO01       |                                       | K                               | CO00                        | 20081211                       | 99991230                     | 1                                       | CONS_LATAM   |                    | 81900              | 5100001959           |                            | 0                               | 20081211                         | X                                      |                  |                                                          | RPULCINO                             | 2                             |

    And I wait "/edm/source_list_v1" Async Queue complete

    Given I import "/plan/cns_spl_pln_loc" by keyFields "sourceSystem,localNumber,localName,vendorOrCustomer"
      | localCountry | localCurrency | localName                       | localNumber | localPlant | localRegion | pLanlocTypeDesc | pLanlocTypeId | planLocTypeDesc           | planLocTypeId | sourceSystem | vendorOrCustomer | specLocAtt1 | _1specLocAtt | _1specLocAttDesc | _2specLocAtt | _2specLocAttDesc | _2specLocAttdEsc | _3specLocAtt | _3specLocAttDesc | specLocAtt2 | specLocAtt3 | specLocAttDesc1 | specLocAttDesc2 | specLocAttDesc3 | vendororCustomer |
      | CO           | USE           | LODISAL S.A.                    | 0000012398  | CO01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |
      | CL           | CRC           | D.H.L. COSTA RICA (CORMAR) S.A. | 0000050161  | CL01       | 103         |                 |               | Affiliate/Market Copacker | SUBCON        | CONS_LATAM   | V                |             |              |                  |              |                  |                  |              |                  |             |             |                 |                 |                 |                  |

    And I wait "/plan/cns_spl_pln_loc" Async Queue complete

    Given I import "/plan/cns_material_plan_status" by keyFields "sourceSystem,localMaterialNumber,localPlant"
      | localMaterialNumber | sourceSystem | localPlant | active | dpRelevant | localParentCode    | materialNumber | noPlanRelevant | parentActive | ppc   | spRelevant |
      | 55735               | CONS_LATAM   | PA01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382 | X          |

    And I wait "/plan/cns_material_plan_status" Async Queue complete


    Given I import "/edm/plant_v1" by keyFields "sourceSystem,localPlant"
      | country | localCountry | localCurrency | localPlanningRelevant | localPlant | localPlantName                  | localPlantType | plant | plantType               | region                                    | site                 | sourceSystem |
      | MX      | MX           | MXN           | X                     | CL01       | Sales & Marketing               | DC             | CL01  | DC, Distribution Center | MX, MEXICO MEXICO                         | Importadora DC       | CONS_LATAM   |
      | VE      | VE           | VEF           | X                     | VE02       | J&J VE-Valencia-DistribuiciÃ³n  | DC             | VE02  | DC, Distribution Center | VE, VENEZUELA VENEZUELA                   | Valencia DC          | CONS_LATAM   |
      | GT      | GT           | GTQ           | X                     | GT02       | J&J Guatemala - Bond Fiscal     | DC             | GT02  | DC, Distribution Center | GT, GUATEMALA GUATEMALA                   | Guatemala BF DC      | CONS_LATAM   |
      | AR      | AR           | ARS           | X                     | AR01       | Pilar Plant                     | DC             | AR01  | MP, Manufacturing Plant | AR, ARGENTINA ARGENTINA                   | Pilar                | CONS_LATAM   |
      | DO      | DO           | DOP           | X                     | DO01       | J&J DO-S.Domingos 1-R.Dominica  | DC             | DO01  | DC, Distribution Center | DO, DOMINICAN REPUBLIC DOMINICAL REPUBLIC | Dominica             | CONS_LATAM   |
      | CO      | CO           | BRL           | X                     | CO01       | J&J Colombia - LADS (CO01)      | DC             | CO01  | MP, Manufacturing Plant | CO, COLOMBIA COLOMBIA                     | Cali                 | CONS_LATAM   |
      | VE      | VE           | VEF           | X                     | BR16       | J&J VE-Valencia-ETHNOR          |                | BR16  | DC, Distribution Center | VE, VENEZUELA VENEZUELA                   | Valencia Ethnor DC   | CONS_LATAM   |
      | AR      | AR           | ARS           | X                     | AR02       | S & M Pilar                     | DC             | AR02  | DC, Distribution Center | AR, ARGENTINA ARGENTINA                   | Pilar DC             | CONS_LATAM   |
      | PA      | PA           | PAB           | X                     | PA01       | J&J Panama - Zona Libre         | DC             | PA01  | DC, Distribution Center | PA, PANAMA PANAMA                         | Panama Zona Libre DC | CONS_LATAM   |
      | BR      | BR           | BRL           | X                     | BR07       | J&J BR-JoÃ£o Pessoa-COM&Distrib | DC             | BR07  | DC, Distribution Center | BR, BRAZIL BRAZIL                         | Pessoa DC            | CONS_LATAM   |

    And I wait "/edm/plant_v1" Async Queue complete




    And I will remove the test file on sink application "GDMTransportMergeMain.tsv"
    When I submit task with xml file "xml/omp/OMPGdmTransport.xml" and execute file "jar/pangea-view.jar"
    Then A file is found on sink application with name "GDMTransportMergeMain.tsv"
    And I check file data for filename "GDMTransportMergeMain.tsv" by keyFields "transportId"
    #Then I check region data "/omp/gdm_transport" by keyFields "transportId"

      | transportId                                 | active | activeOPRERP | activeSOPERP | endEff              | fromLocationId        | fromProductId | label                                                                                                                       | machineTypeId | minQuantity | planLevelId | processTypeId           | purchasingGroup | purchasingOrganization | startEff            | toLocationId    | toProductId | transportOffset | transportType | vendorId |
      | 58722/CONS_LATAM_BR12/CONS_LATAM_BR07       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | B32             | BR00                   | 2018/01/01 00:00:00 | CONS_LATAM_BR07 | 58722       | 17              | Truck         | 99999    |
      | 58722/CONS_LATAM_BR12/CONS_LATAM_BR16       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | B31             |                        | 2018/01/01 00:00:00 | CONS_LATAM_BR16 | 58722       | 2               | Truck         |          |
      | 97360/CONS_LATAM_CO01$12398/CONS_LATAM_CO01 | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_CO01$12398 | 97360         | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | TRANSPORT     | 0.0         | *           | SubcontractingTransport | B30             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01 | 97360       | 33              | Ship          | 12398    |
      | 60520/CONS_LATAM_V_50161/CONS_LATAM_CL01    | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_V_50161    | 60520         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | TRANSPORT     | 0.0         | *           | VendorTransport         | A17             | CL00                   | 2018/01/01 00:00:00 | CONS_LATAM_CL01 | 60520       | 42              | Ship          | 50161    |
      | 55755/CONS_LATAM_BR12/CONS_LATAM_CO01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_BR12       | 55755         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01 | 55755       | 24              | Ship          | 42221    |
      | 55735/CONS_LATAM_CO02/CONS_LATAM_PA01       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_CO02       | 55735         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | AR00                   | 2018/01/01 00:00:00 | CONS_LATAM_PA01 | 55735       | 24              | Ship          | 4676     |









    And I execute xd job to merge file "GDMTransportMerge*" to "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, requirementOffset, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"
    And I check file data for filename "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, requirementOffset, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"
      | transportId                                 | active | activeOPRERP | activeSOPERP | endEff              | fromLocationId        | fromProductId | label                                                                                                                       | machineTypeId | minQuantity | planLevelId | processTypeId           | purchasingGroup | purchasingOrganization | startEff            | toLocationId    | toProductId | transportOffset | transportType | vendorId |
      | 55755/CONS_LATAM_BR12/CONS_LATAM_CO01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_BR12       | 55755         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | PRD             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01 | 55755       | 14              | Air           | 8917     |
      | 57492/CONS_LATAM_UY01$65659/CONS_LATAM_UY01 | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_UY01$65659 | 57492         | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | TRANSPORT     | 0.0         | *           | SubcontractingTransport | B30             | UY00                   | 2018/01/01 00:00:00 | CONS_LATAM_UY01 | 57492       | 7               | Air           | 65659    |
      | 88732/CONS_LATAM_V_19574/CONS_LATAM_EC01    | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_V_19574    | 88732         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | TRANSPORT     | 0.0         | *           | VendorTransport         | B31             | EC00                   | 2018/01/01 00:00:00 | CONS_LATAM_EC01 | 88732       | 14              | Air           | 19574    |
      | 55735/CONS_LATAM_CO02/CONS_LATAM_PA01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_CO02       | 55735         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | PA00                   | 2018/01/01 00:00:00 | CONS_LATAM_PA01 | 55735       | 7               | Air           | 4676     |


      | 58722/CONS_LATAM_BR12/CONS_LATAM_BR07       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | B32             | BR00                   | 2018/01/01 00:00:00 | CONS_LATAM_BR07 | 58722       | 17              | Truck         | 99999    |
      | 58722/CONS_LATAM_BR12/CONS_LATAM_BR16       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_BR12       | 58722         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       | B31             |                        | 2018/01/01 00:00:00 | CONS_LATAM_BR16 | 58722       | 2               | Truck         |          |
      | 97360/CONS_LATAM_CO01$12398/CONS_LATAM_CO01 | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_CO01$12398 | 97360         | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | TRANSPORT     | 0.0         | *           | SubcontractingTransport | B30             | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01 | 97360       | 33              | Ship          | 12398    |
      | 60520/CONS_LATAM_V_50161/CONS_LATAM_CL01    | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_V_50161    | 60520         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | TRANSPORT     | 0.0         | *           | VendorTransport         | A17             | CL00                   | 2018/01/01 00:00:00 | CONS_LATAM_CL01 | 60520       | 42              | Ship          | 50161    |
      | 55755/CONS_LATAM_BR12/CONS_LATAM_CO01       | YES    | YES          | NO           | 2998/12/31 23:59:59 | CONS_LATAM_BR12       | 55755         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | CO00                   | 2018/01/01 00:00:00 | CONS_LATAM_CO01 | 55755       | 24              | Ship          | 42221    |
      | 55735/CONS_LATAM_CO02/CONS_LATAM_PA01       | YES    | YES          | NO           | 2998/12/31 00:00:00 | CONS_LATAM_CO02       | 55735         | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | TRANSPORT     | 0.0         | *           | InternalTransport       |                 | AR00                   | 2018/01/01 00:00:00 | CONS_LATAM_PA01 | 55735       | 24              | Ship          | 4676     |

    And I will remove all data with region "/omp/gdm_transport"
    And I will remove all data with region "/plan/cns_tlane_item"
    And I will remove all data with region "/plan/cns_tlane_item_exception"
    And I will remove all data with region "/plan/cns_process_type"
    And I will remove all data with region "/plan/cns_material_plan_status"
    And I will remove all data with region "/plan/cns_spl_pln_loc"
    And I will remove all data with region "/edm/plant_v1"
    And I will remove all data with region "/edm/source_list_v1"
    And I will remove all data with region "/edm/material_global_v1"
    And I will remove all data with region "/edm/material_plant_v1"
    And I will remove the test file on sink application "GDMTransportMergeException.tsv"
    And I will remove the test file on sink application "GDMTransportMergeMain.tsv"


  @Scenario2
  Scenario: Full Load consumption /plan/cns_tlane_item_Exception



		# TEST AGAINST DEV
#		When I submit task with xml file "xml/omp/OMPGdmTransportException.xml" and execute file "jar/pangea-view.jar"
#		Then A file is found on sink application with name "GDMTransportMergeException.tsv"
#		When I submit task with xml file "xml/omp/OMPGdmTransport.xml" and execute file "jar/pangea-view.jar"
#		Then A file is found on sink application with name "GDMTransportMergeMain.tsv"
#		And I execute xd job to merge file "GDMTransportMerge*" to "GDMTransport.tsv" by keyFields "machineTypeId, processTypeId, transportId, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"

		# TEST AGAINST LOCAL VM`
    Given I import "/plan/cns_tlane_item_exception" by keyFields "sequenceNumber,tlaneName,materialNumber"
      | sequenceNumber | tlaneName  | materialNumber | validFrom | validTo  | originLocation  | destinationLocation | mode | leadTime | deletionIndicator | processTypeId     | refSeqNumTlaneItem |
      | 100            | CO01toBR12 | 59816          | 20180101  | 20181231 | CONS_LATAM_CO01 | CONS_LATAM_BR12     | Ship | 77       |                   | InternalTransport |                    |
      | 1              | BR12toBR07 | 60109          | 20180101  | 20181231 | CONS_LATAM_BR12 | CONS_LATAM_BR07     | Ship | 7        | X                 | InternalTransport | 1                  |
      | 1              | BR12toBR07 | 60109          | 20180101  | 20181231 | CONS_LATAM_BR12 | CONS_LATAM_BR07     | Air  | 2        |                   | InternalTransport |                    |
      | 400            | BR12toBR25 | 441526         | 20180101  | 20181231 | CONS_LATAM_BR12 | CONS_LATAM_BR25     | Ship | 4        |                   | InternalTransport |                    |

    And I wait "/plan/cns_tlane_item_exception" Async Queue complete

    Given I import "/plan/cns_tlane_item" by keyFields "sequenceNumber,tlaneName,materialNumber"
      | sequenceNumber | tlaneName   | materialNumber | validFrom | validTo  | originLocation     | destinationLocation | mode | leadTime | processTypeId           |
      | 1              | BR12toBR07  | 60109          | 20180101  | 20181231 | CONS_LATAM_BR12    | CONS_LATAM_BR07     | Ship | 7        | InternalTransport       |
      | 2              | BR12toBR26  | 441526         | 20180101  | 20181231 | CONS_LATAM_BR12    | CONS_LATAM_BR25     | Ship | 4        | InternalTransport       |
      | 3              | BR07toBR12  | 59816          | 20180101  | 20181231 | CONS_LATAM_BR07    | CONS_LATAM_BR12     | Ship | 77       | InternalTransport       |
      | 4              | CO01toPE01  | 88382          | 20180101  | 99991231 | CONS_LATAM_CO01    | CONS_LATAM_PE01     | Ship | 28       | InternalTransport       |
      | 5              | AR01toAR02  | 69056          | 20180101  | 99991231 | CONS_LATAM_AR01    | CONS_LATAM_AR02     | Ship | 1        | InternalTransport       |
      | 26             | 15574toCO01 | 93937          | 20180101  | 99991231 | CONS_LATAM_V_15574 | CONS_LATAM_CO01     | Ship | 28       | SubcontractingTransport |
      | 27             | 50161toCO01 | 93616          | 20180101  | 99991231 | CONS_LATAM_V_50161 | CONS_LATAM_CO01     | Ship | 35       | VendorTransport         |

    And I wait "/plan/cns_tlane_item" Async Queue complete

    Given I import "/plan/cns_process_type" by keyFields "processTypeId"
      | processTypeId           | processTypeDesc                                                                                                                                 |
      | InternalTransport       | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP)                     |
      | VendorTransport         | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                                         |
      | SubcontractingTransport | Subcontracting Transport (Transport to ship components to a subcontractor)                                                                      |
      | Subcontracting          | Subcontracting                                                                                                                                  |
      | ExternalPurchase        | External Purchase                                                                                                                               |
      | VendorPurchase          | Vendor Purchase                                                                                                                                 |
      | InterERPTransport       | InterERP Transport (Transport between 2 different ERP systems, modeled through sales order/purchase order)                                      |
      | Production              | Production                                                                                                                                      |
      | ExternalTransport       | External Transport (Transport from 1 fiscal entity to another fiscal entity in the same ERP system, modeled through sales order/purchase order) |

    And I wait "/plan/cns_process_type" Async Queue complete

    Given I import "/edm/material_plant_v1" by keyFields "localMaterialNumber,localPlant,sourceSystem"
      | localMaterialNumber | sourceSystem | purchsngGrpCd | localPlant | materialNumber | localAbcIndicator | localBaseQuantity | localBatchManagementRequirementIndicator | localCheckingGroupForAvailabilityCheck | localComponentScrap | localComponentScrapInPercent | localConsumptionMode | localConsumptionPeriodBackward | localConsumptionPeriodForward | localCriticalPart | localDeletionFlagPlant | localDependentRequirements | localFixedLotSize | localGoodsReceiptProcessingTimeInDays | localInHouseProcessingTime | localLotSize | localMaximumLotSize | localMaximumStockLevel | localMinimumLotSize | localMinimumSafetyStock | localMrpController | localMrpType | localPlannedDeliveryTimeInDays | localPlanningStrategyGroup | localPlanningTimeFence | localPlantStatus | localPostToInspStk | localPostToInspectionStock | localProcurementType | localProductionSupervisor | localProductionUnit | localRoundingValueForPoq | localSafetyStock | localSafetyTime | localSafetyTimeIndicator | localSpecialProcurementType | plant | plantStatus |
      | 88382               | CONS_LATAM   | A01           | PE01       | 88382          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            | 2                    | 45                             | 7                             |                   |                        | 1                          | 0                 | 15                                    | 0                          | MB           | 0                   | 0                      | 1                   | 0                       | U01                | X0           | 0                              | 40                         | 0                      | 11               |                    |                            | F                    |                           |                     | 1                        | 0                | 0               |                          | 44                          | UY07  |             |
      | 69056               | CONS_LATAM   | A02           | AR02       | 69056          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 90                          |       |             |
      | 93937               | CONS_LATAM   | A03           | CO01       | 93937          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |       |             |
      | 93616               | CONS_LATAM   | A04           | CO01       | 93937          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          |                             |       |             |
      | 60109               | CONS_LATAM   | A05           | BR07       | 60109          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            | 2                    | 45                             | 7                             |                   |                        | 1                          | 0                 | 15                                    | 0                          | MB           | 0                   | 0                      | 1                   | 0                       | U01                | X0           | 0                              | 40                         | 0                      | 11               |                    |                            | F                    |                           |                     | 1                        | 0                | 0               |                          | 44                          |       |             |
      | 441526              | CONS_LATAM   | A06           | BR26       | 441526         |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 90                          |       |             |
      | 59816               | CONS_LATAM   | A07           | BR12       | 59816          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |       |             |
      | 441526              | CONS_LATAM   | A08           | BR25       | 441526         |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 90                          |       |             |
      | 88382               | CONS_LATAM   | A09           | CO01       | 88382          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            | 2                    | 45                             | 7                             |                   |                        | 1                          | 0                 | 15                                    | 0                          | MB           | 0                   | 0                      | 1                   | 0                       | U01                | X0           | 0                              | 40                         | 0                      | 11               |                    |                            | F                    |                           |                     | 1                        | 0                | 0               |                          | 44                          | UY07  |             |
      | 69056               | CONS_LATAM   | A10           | AR01       | 69056          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 90                          |       |             |
      | 60109               | CONS_LATAM   | A11           | BR12       | 60109          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            | 2                    | 45                             | 7                             |                   |                        | 1                          | 0                 | 15                                    | 0                          | MB           | 0                   | 0                      | 1                   | 0                       | U01                | X0           | 0                              | 40                         | 0                      | 11               |                    |                            | F                    |                           |                     | 1                        | 0                | 0               |                          | 44                          |       |             |
      | 441526              | CONS_LATAM   | A12           | BR12       | 441526         |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 90                          |       |             |
      | 59816               | CONS_LATAM   | A13           | BR07       | 59816          |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 30                          |       |             |
      | 441526              | CONS_LATAM   | A14           | BR12       | 441526         |                   | 0                 | X                                        | 2                                      | 0                   | 0                            |                      | 0                              | 0                             |                   |                        |                            | 0                 | 0                                     | 0                          |              | 0                   | 0                      | 0                   | 0                       | U01                | X0           | 0                              |                            | 0                      | 13               |                    |                            | F                    |                           |                     | 0                        | 0                | 0               |                          | 90                          |       |             |

    And I wait "/edm/material_plant_v1" Async Queue complete

    Given I import "/edm/material_global_v1" by keyFields "sourceSystem,localMaterialNumber"
      | materialNumber | localMaterialNumber | sourceSystem | primaryPlanningCode | baseUom | batchManageIndicator | brand | category | division | flagForDeletion | form | franchise | globalBusinessUnit | globalDpParentCode | localBaseUom | localDpParentCode | localManufacturingTechnology | localMaterialGroup | localMaterialType | localRefDescription           | manufacturingTechnology | materialGroup | materialStatus | materialType | minRemShelfLife | parentCode | productFamily | refDescription | subBrand | totalShelfLife |
      | 88382          | 88382               | CONS_LATAM   | 88382               |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 11             |              | 0               |            |               |                |          | 0              |
      | 69056          | 69056               | CONS_LATAM   | 69056               |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 13             |              | 0               |            |               |                |          | 0              |
      | 93937          | 93937               | CONS_LATAM   | 93937               |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 11             |              | 0               |            |               |                |          | 0              |
      | 93616          | 93616               | CONS_LATAM   |                     |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 13             |              | 0               |            |               |                |          | 0              |
      | 60109          | 60109               | CONS_LATAM   | 60109               |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 11             |              | 0               |            |               |                |          | 0              |
      | 441526         | 441526              | CONS_LATAM   | 441526              |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 13             |              | 0               |            |               |                |          | 0              |
      | 59816          | 59816               | CONS_LATAM   | 59816               |         |                      |       |          |          |                 |      |           |                    |                    | EA           |                   |                              |                    | CBAU              | EMS - Indisponivel para LATAM |                         |               | 11             |              | 0               |            |               |                |          | 0              |

    And I wait "/edm/material_global_v1" Async Queue complete

    Given I import "/edm/source_list_v1" by keyFields "sourceSystem,localMaterialNumber,localPlant,localNumberofSourceListRecord"
      | localMaterialNumber | sourceSystem | localPlant | localPurchasingOrganization | localSourceListRecordValidFrom | localSourceListRecordValidTo | localBlockedSourceofSupply | localVendorAccountNumber | localAgreementItem | localAgreementNumber | localCategoryofSourceListRecord | localDateonWhichRecordWasCreated | localFixedOutlinePurchaseAgreementItem | localFixedvendor | localMaterialNumberCorrespondingtoManufacturerPartNumber | localNameofPersonwhoCreatedtheObject | localNumberofSourceListRecord | localPlantfromWhichMaterialisProcured | localPurchasingDocumentCategory | localSourceListUsageinMaterialsPlanning |
      | 93937               | CONS_LATAM   | CO01       | CO00                        | 20030206                       | 29991231                     |                            | 15574                    | 0                  |                      | 7                               | 20030306                         |                                        |                  |                                                          | CCASTRO1                             | 4                             | CO01                                  |                                 |                                         |
      | 93616               | CONS_LATAM   | CO01       | CO00                        | 20020301                       | 99991231                     |                            | 50161                    | 0                  |                      | 7                               | 20020522                         |                                        |                  |                                                          | CARGA03                              | 2                             | CO01                                  |                                 |                                         |
      | 60109               | CONS_LATAM   | BR07       | BR00                        | 20030206                       | 29991231                     |                            | 15574                    | 0                  |                      | 7                               | 20030306                         |                                        |                  |                                                          | CCASTRO1                             | 4                             | CO01                                  |                                 |                                         |
      | 441526              | CONS_LATAM   | BR25       | BR00                        | 20020301                       | 99991231                     |                            | 50161                    | 0                  |                      | 7                               | 20020522                         |                                        |                  |                                                          | CARGA03                              | 2                             | CO01                                  |                                 |                                         |
      | 59816               | CONS_LATAM   | BR12       | BR00                        | 20030206                       | 29991231                     |                            | 15574                    | 0                  |                      | 7                               | 20030306                         |                                        |                  |                                                          | CCASTRO1                             | 4                             | CO01                                  |                                 |                                         |
      | 88382               | CONS_LATAM   | PE01       | PE00                        | 20020301                       | 99991231                     |                            | 50161                    | 0                  |                      | 7                               | 20020522                         |                                        |                  |                                                          | CARGA03                              | 2                             | CO01                                  |                                 |                                         |
      | 69056               | CONS_LATAM   | AR02       | AR00                        | 20020301                       | 99991231                     |                            | 50161                    | 0                  |                      | 7                               | 20020522                         |                                        |                  |                                                          | CARGA03                              | 2                             | CO01                                  |                                 |                                         |

    And I wait "/edm/source_list_v1" Async Queue complete

    Given I import "/plan/cns_spl_pln_loc" by keyFields "sourceSystem,localNumber,localName,vendorOrCustomer"
      | sourceSystem | localNumber | localName                           | vendorOrCustomer | localPlant | localCountry | localCurrency | localRegion | pLanlocTypeDesc    | pLanlocTypeId | specLocAtt1 | specLocAtt2 | specLocAtt3 | specLocAttDesc1 | specLocAttDesc2 | specLocAttDesc3 |
      | CONS_LATAM   | 15574       | ASPRILLA ORTIZ FABIO                | V                | CO01       | CO           | COP           | 103         | Mfg Plant Copacker | SUBCON        |             |             |             |                 |                 |                 |
      | CONS_LATAM   | 50161       | AVP MAQUILA DE MEXICO S DE RL DE CV | V                | CO01       | MX           | MXN           | 103         | VENDOR             | SUBCON        |             |             |             |                 |                 |                 |

    And I wait "/plan/cns_spl_pln_loc" Async Queue complete

    Given I import "/plan/cns_material_plan_status" by keyFields "sourceSystem,localMaterialNumber,localPlant"
      | localMaterialNumber | sourceSystem | localPlant | active | dpRelevant | localParentCode    | materialNumber | noPlanRelevant | parentActive | ppc    | spRelevant |
      | 88382               | CONS_LATAM   | PE01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382  | X          |
      | 69056               | CONS_LATAM   | AR02       | X      | X          | 178962124094540000 | 69056          |                | X            | 69056  | X          |
      | 93937               | CONS_LATAM   | CO01       | X      | X          | 178962124094540000 | 945            |                | X            | 93937  | X          |
      | 93616               | CONS_LATAM   | CO01       | X      | X          | 178962124094540000 | 945            |                | X            |        | X          |
      | 60109               | CONS_LATAM   | BR07       | X      | X          | 178962124094540000 | 60109          |                | X            | 60109  | X          |
      | 441526              | CONS_LATAM   | BR26       | X      | X          | 178962124094540000 | 441526         |                | X            | 441526 | X          |
      | 59816               | CONS_LATAM   | BR12       | X      | X          | 178962124094540000 | 59816          |                | X            | 59816  | X          |
      | 441526              | CONS_LATAM   | BR25       | X      | X          | 178962124094540000 | 441526         |                | X            | 441526 | X          |
      | 88382               | CONS_LATAM   | CO01       | X      | X          | 178962124094540000 | 88382          |                | X            | 88382  | X          |
      | 69056               | CONS_LATAM   | AR01       | X      | X          | 178962124094540000 | 69056          |                | X            | 69056  | X          |
      | 60109               | CONS_LATAM   | BR12       | X      | X          | 178962124094540000 | 60109          |                | X            | 60109  | X          |
      | 441526              | CONS_LATAM   | BR12       | X      | X          | 178962124094540000 | 441526         |                | X            | 441526 | X          |
      | 59816               | CONS_LATAM   | BR07       | X      | X          | 178962124094540000 | 59816          |                | X            | 59816  | X          |
      | 441526              | CONS_LATAM   | BR12       | X      | X          | 178962124094540000 | 441526         |                | X            | 441526 | X          |

    And I wait "/plan/cns_material_plan_status" Async Queue complete

    Given I import "/edm/plant_v1" by keyFields "sourceSystem,localPlant"
      | sourceSystem | localPlant | localPlanningRelevant | country | localCurrency | plantType               | localPlantType | site                 | localCountry | plant | localPlantName                 | region                                    |
      | CONS_LATAM   | AR01       |                       | AR      | ARS           | MP, Manufacturing Plant |                | Pilar                | AR           | AR06  | Pilar Plant                    | AR, ARGENTINA ARGENTINA                   |
      | CONS_LATAM   | AR02       |                       | AR      | ARS           | DC, Distribution Center | DC             | Pilar DC             | AR           | AR07  | S & M Pilar                    | AR, ARGENTINA ARGENTINA                   |
      | CONS_LATAM   | BR07       | X                     | -       | BRL           | DC, Distribution Center | DC             | Pessoa DC            | BR           | BR54  | J&J BR-João Pessoa-COM&Distrib | BR, BRAZIL BRAZIL                         |
      | CONS_LATAM   | BR12       | X                     | -       | BRL           | MP, Manufacturing Plant |                | Sao Jose dos Campos  | BR           | BR59  | J&J BR São José Campos - Indus | BR, BRAZIL BRAZIL                         |
      | CONS_LATAM   | BR16       |                       | -       | BRL           | DC, Distribution Center | DC             | Extrema DC           | BR           | BR61  | J&J BR-Extrema - Com&Distrib   | BR, BRAZIL BRAZIL                         |
      | CONS_LATAM   | BR19       |                       | -       | BRL           | DC, Distribution Center | DC             | Nova Odessa DC       | BR           | BR63  | J&J BR-Nova Odessa - Com&Distr | BR, BRAZIL BRAZIL                         |
      | CONS_LATAM   | BR25       | X                     | -       | BRL           | DC, Distribution Center | DC             | Goiania DC           | BR           | BR69  | J&J BR-Goiânia - Com&Distrib   | BR, BRAZIL BRAZIL                         |
      | CONS_LATAM   | CL01       |                       | CL      | CLP           | DC, Distribution Center | DC             | Chile DC             | CL           | CL03  | J&J CL-Santiago-Chile Consumer | CL, CHILE CHILE                           |
      | CONS_LATAM   | CO01       | X                     |         |               | MP, Manufacturing Plant |                | Cali                 |              | CO07  | J&J Colombia - LADS (CO01)     | CO, COLOMBIA COLOMBIA                     |
      | CONS_LATAM   | CO02       |                       |         |               | DC, Distribution Center |                | Cali DC              |              | CO08  | J&J Colombia - S&M (CO02)      | CO, COLOMBIA COLOMBIA                     |
      | CONS_LATAM   | CR01       |                       | -       | CRC           | DC, Distribution Center | DC             | Costa Rica DC        | CR           | CR01  | J&J Costa Rica - S&M Consumer  | CR, COSTA RICA COSTA RICA                 |
      | CONS_LATAM   | CR02       |                       | -       | CRC           | DC, Distribution Center | DC             | Costa Rica BF DC     | CR           | CR02  | J&J Costa Rica - Bond Fiscal   | CR, COSTA RICA COSTA RICA                 |
      | CONS_LATAM   | DO01       |                       | DO      | DOP           | DC, Distribution Center | DC             | Dominica             | DO           | DO02  | J&J DO-S.Domingos 1-R.Dominica | DO, DOMINICAN REPUBLIC DOMINICAL REPUBLIC |
      | CONS_LATAM   | EC01       |                       |         |               | DC, Distribution Center | DC             | Ecuador DC           |              | EC03  | Johnson & Johnson del Ecuador  | EC, ECUADOR ECUADOR                       |
      | CONS_LATAM   | GT01       |                       | -       | GTQ           | DC, Distribution Center | DC             | Guatemala DC         | GT           | GT01  | J&J Guatemala - S&M Consumer   | GT, GUATEMALA GUATEMALA                   |
      | CONS_LATAM   | GT02       |                       | -       | GTQ           | DC, Distribution Center | DC             | Guatemala BF DC      | GT           | GT02  | J&J Guatemala - Bond Fiscal    | GT, GUATEMALA GUATEMALA                   |
      | CONS_LATAM   | MX01       |                       | MX      | MXN           | DC, Distribution Center | DC             | PT Importadora DC    | MX           | MX31  | PT Importado                   | MX, MEXICO MEXICO                         |
      | CONS_LATAM   | MX02       |                       | MX      | MXN           | DC, Distribution Center | DC             | Importadora DC       | MX           | MX32  | Sales & Marketing              | MX, MEXICO MEXICO                         |
      | CONS_LATAM   | PA01       |                       | PA      | PAB           | DC, Distribution Center | DC             | Panama DC            | PA           | PA05  | J&J Panama - S&M Consumer      | PA, PANAMA PANAMA                         |
      | CONS_LATAM   | PA03       |                       | PA      | PAB           | DC, Distribution Center | DC             | Panama Zona Libre DC | PA           | PA06  | J&J Panama - Zona Libre        | PA, PANAMA PANAMA                         |
      | CONS_LATAM   | PE01       |                       | PE      | PEN           | DC, Distribution Center | DC             | Peru DC              | PE           | PE03  | J&J PE-Lima-S&M                | PE, PERU PERU                             |
      | CONS_LATAM   | PY01       |                       | PY      | PYG           | DC, Distribution Center | DC             | Paraguay             | PY           | PY01  | S & M Consumer                 | PY, PARAGUAY PARAGUAY                     |
      | CONS_LATAM   | UY01       |                       | UY      | UYU           | DC, Distribution Center | DC             | Uruguay              | UY           | UY07  | S & M Consumer                 | UY, URUGUAY URUGUAY                       |
      | CONS_LATAM   | UY05       |                       | UY      | UYU           | DC, Distribution Center | DC             | Recinto Aduanero     | UY           | UY05  | S & M Consumer RecintoAduanero | UY, URUGUAY URUGUAY                       |
      | CONS_LATAM   | VE01       |                       | VE      | VEF           | MP, Manufacturing Plant |                | Valencia             | VE           | VE06  | J&J VE-Valencia-Planta         | VE, VENEZUELA VENEZUELA                   |
      | CONS_LATAM   | VE02       |                       | VE      | VEF           | DC, Distribution Center | DC             | Valencia DC          | VE           | VE07  | J&J VE-Valencia-Distribuición  | VE, VENEZUELA VENEZUELA                   |
      | CONS_LATAM   | VE05       |                       | VE      | VEF           | DC, Distribution Center |                | Valencia Ethnor DC   | VE           | VE05  | J&J VE-Valencia-ETHNOR         | VE, VENEZUELA VENEZUELA                   |

    And I wait "/edm/plant_v1" Async Que  ue complete

    And I will remove the test file on sink application "GDMTransportMergeException.tsv"

    And I will remove the test file on sink application "GDMTransport.tsv"

    When I submit task with xml file "xml/omp/OMPGdmTransportException.xml" and execute file "jar/pangea-view.jar"

    Then A file is found on sink application with name "GDMTransportMergeException.tsv"

    And I check file data for filename "GDMTransportMergeException.tsv" by keyFields "transportId"
      | machineTypeId | processTypeId     | transportId                            | purchasingOrganization | active | vendorId | purchasingGroup | label                                                                                                                       | toLocationId    | fromLocationId  | planLevelId | activeOPRERP | activeSOPERP | minQuantity | transportOffset | toProductId | transportType | endEff              | fromProductId | startEff            |
      | TRANSPORT     | InternalTransport | 60109/CONS_LATAM_BR12/CONS_LATAM_BR07  | BR00                   | YES    | 15574    | A05             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_BR07 | CONS_LATAM_BR12 | *           | YES          | NO           | 0.0         | 2               | 60109       | Air           | 2018/12/31 00:00:00 | 60109         | 2018/01/01 00:00:00 |
      | TRANSPORT     | InternalTransport | 441526/CONS_LATAM_BR12/CONS_LATAM_BR25 | BR00                   | YES    | 50161    | A08             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_BR25 | CONS_LATAM_BR12 | *           | YES          | NO           | 0.0         | 4               | 441526      | Ship          | 2018/12/31 00:00:00 | 441526        | 2018/01/01 00:00:00 |
      | TRANSPORT     | InternalTransport | 59816/CONS_LATAM_CO01/CONS_LATAM_BR12  | BR00                   | YES    | 15574    | A07             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_BR12 | CONS_LATAM_CO01 | *           | YES          | NO           | 0.0         | 77              | 59816       | Ship          | 2018/12/31 00:00:00 |               | 2018/01/01 00:00:00 |


    And I will remove the test file on sink application "GDMTransportMergeMain.tsv"

    When I submit task with xml file "xml/omp/OMPGdmTransport.xml" and execute file "jar/pangea-view.jar"

    Then A file is found on sink application with name "GDMTransportMergeMain.tsv"

    And I check file data for filename "GDMTransportMergeMain.tsv" by keyFields "machineTypeId, processTypeId, transportId, purchasingOrganization, active, vendorId, purchasingGroup, label, toLocationId, fromLocationId, planLevelId, activeOPRERP, activeSOPERP, minQuantity, transportOffset, toProductId, transportType, endEff, fromProductId, startEff"
      | machineTypeId | processTypeId           | transportId                              | purchasingOrganization | active | vendorId | purchasingGroup | label                                                                                                                       | toLocationId    | fromLocationId     | planLevelId | activeOPRERP | activeSOPERP | minQuantity | transportOffset | toProductId | transportType | endEff              | fromProductId | startEff            |
      | TRANSPORT     | InternalTransport       | 88382/CONS_LATAM_CO01/CONS_LATAM_PE01    | PE00                   | YES    | 50161    | A01             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_PE01 | CONS_LATAM_CO01    | *           | YES          | NO           | 0.0         | 28              | 88382       | Ship          | 2998/12/31 23:59:59 | 88382         | 2018/01/01 00:00:00 |
      | TRANSPORT     | InternalTransport       | 441526/CONS_LATAM_BR12/CONS_LATAM_BR25   | BR00                   | YES    | 50161    | A08             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_BR25 | CONS_LATAM_BR12    | *           | YES          | NO           | 0.0         | 4               | 441526      | Ship          | 2018/12/31 00:00:00 | 441526        | 2018/01/01 00:00:00 |
      | TRANSPORT     | VendorTransport         | 93616/CONS_LATAM_V_50161/CONS_LATAM_CO01 | CO00                   | YES    | 50161    | A04             | Vendor Transport (specific for the Pangea Vendor modeling: transport from a Vendor location to a plant)                     | CONS_LATAM_CO01 | CONS_LATAM_V_50161 | *           | YES          | NO           | 0.0         | 35              | 93616       | Ship          | 2998/12/31 23:59:59 | 93616         | 2018/01/01 00:00:00 |
      | TRANSPORT     | InternalTransport       | 69056/CONS_LATAM_AR01/CONS_LATAM_AR02    | AR00                   | YES    | 50161    | A02             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_AR02 | CONS_LATAM_AR01    | *           | YES          | NO           | 0.0         | 1               | 69056       | Ship          | 2998/12/31 23:59:59 | 69056         | 2018/01/01 00:00:00 |
      | TRANSPORT     | InternalTransport       | 59816/CONS_LATAM_BR07/CONS_LATAM_BR12    | BR00                   | YES    | 15574    | A07             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_BR12 | CONS_LATAM_BR07    | *           | YES          | NO           | 0.0         | 77              | 59816       | Ship          | 2018/12/31 00:00:00 | 59816         | 2018/01/01 00:00:00 |
      | TRANSPORT     | InternalTransport       | 60109/CONS_LATAM_BR12/CONS_LATAM_BR07    | BR00                   | YES    | 15574    | A05             | Internal Transport (Transport from 1 plant to another plant in the same ERP system, modeled through transport lanes in SAP) | CONS_LATAM_BR07 | CONS_LATAM_BR12    | *           | YES          | NO           | 0.0         | 7               | 60109       | Ship          | 2018/12/31 00:00:00 | 60109         | 2018/01/01 00:00:00 |
      | TRANSPORT     | SubcontractingTransport | 93937/CONS_LATAM_V_15574/CONS_LATAM_CO01 | CO00                   | YES    | 15574    | A03             | Subcontracting Transport (Transport to ship components to a subcontractor)                                                  | CONS_LATAM_CO01 | CONS_LATAM_V_15574 | *           | YES          | NO           | 0.0         | 28              | 93937       | Ship          | 2998/12/31 23:59:59 | 93937         | 2018/01/01 00:00:00 |

    And I will remove all data with region "/omp/gdm_transport"
    And I will remove all data with region "/plan/cns_tlane_item"
    And I will remove all data with region "/plan/cns_tlane_item_exception"
    And I will remove all data with region "/plan/cns_process_type"
    And I will remove all data with region "/plan/cns_material_plan_status"
    And I will remove all data with region "/plan/cns_spl_pln_loc"
    And I will remove all data with region "/edm/plant_v1"
    And I will remove all data with region "/edm/source_list_v1"
    And I will remove all data with region "/edm/material_global_v1"
    And I will remove all data with region "/edm/material_plant_v1"

    And I will remove the test file on sink application "GDMTransportMergeException.tsv"
    And I will remove the test file on sink application "GDMTransportMergeMain.tsv"
