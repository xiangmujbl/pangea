@pangea_test @AEAZ-3175
Feature: EDMPurchaseOrderOA

  Scenario: Full Load curation

    Given I import "/project_one/ekko" by keyFields "ebeln,mandt"
      |    ebeln   | bstyp | bsart |   aedat  | lifnr | ekorg | ekgrp | bukrs | waers |   bedat  | kdatb | kdate | llief | reswk | frgrl | lphis | mandt |
      | 3000793997 |   F   |  ZLA  | 20170102 | 6109  |  MX01 |  M39  |  8302 |  MXN  | 20170102 |       |       |       |       |       |       |  120  |
      | 3000794007 |   F   |  ZLA  | 20170102 | 6109  |  MX01 |  M39  |  8302 |  MXN  | 20170102 |       |       |       |       |       |       |  120  |
      | 3000794023 |   F   |  ZLA  | 20170102 | 6109  |  MX01 |  M39  |  8302 |  MXN  | 20170102 |       |       |       |       |       |       |  120  |

    And I wait "/project_one/ekko" Async Queue complete

    Given I import "/project_one/ekpo" by keyFields "ebelp,ebeln,mandt"
    | mandt |    ebeln   | ebelp | loekz | matnr | werks | lgort | bednr | menge     | meins | umrez | umren | insmk | elikz | pstyp | knttp | konnr      | ktpnr | lmein | adrnr | plifz | sobkz | bstae | lblkz | adrn2 |    banfn   | bnfpo |  j1bnbm  | reslo | webaz |
    |  120  | 3000793997 |  10   |       | 58752 |  MX02 |  MX01 |       | 1968.000  |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4950  |   EA  |       |    0  |       |       |       |       | 1603571115 |  10   |          |       |  2    |
    |  120  | 3000793997 |  20   |       | 89295 |  MX02 |  MX01 |       | 10344.000 |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4650  |   EA  |       |    0  |       |       |       |       | 1603563155 |  10   |          |       |  2    |
    |  120  | 3000793997 |  30   |       | 89313 |  MX02 |  MX01 |       | 12648.000 |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4680  |   EA  |       |    0  |       |       |       |       | 1603559777 |  10   |          |       |  2    |
    |  120  | 3000793997 |  40   |       | 89318 |  MX02 |  MX01 |       | 11136.000 |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4920  |   EA  |       |    0  |       |       |       |       | 1603568088 |  10   |          |       |  2    |
    |  120  | 3000793997 |  50   |       | 55719 |  MX02 |  MX01 |       | 4212.000  |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 2780  |   EA  |       |    0  |       |       |       |       | 1603560676 |  10   |          |       |  2    |
    |  120  | 3000793997 |  60   |       | 58800 |  MX02 |  MX01 |       | 1968.000  |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 3050  |   EA  |       |    0  |       |       |       |       | 1603555121 |  10   |          |       |  2    |
    |  120  | 3000793997 |  70   |       | 60414 |  MX02 |  MX01 |       | 5520.000  |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4190  |   EA  |       |    0  |       |       |       |       | 1603559477 |  10   |          |       |  2    |
    |  120  | 3000793997 |  80   |       | 99814 |  MX02 |  MX01 |       | 3264.000  |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4340  |   EA  |       |    0  |       |       |       |       | 1603557667 |  10   |          |       |  2    |
    |  120  | 3000794007 |  10   |       | 89301 |  MX02 |  MX01 |       | 28152.000 |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4620  |   EA  |       |    0  |       |       |       |       | 1603559859 |  10   |          |       |  2    |
    |  120  | 3000794023 |  10   |       | 87831 |  MX02 |  MX01 |       | 39840.000 |  EA   |   1   |   1   |   X   |   X   |   0   |       | 5100003715 | 4580  |   EA  |       |    0  |       |       |       |       | 1603563584 |  10   |          |       |  2    |

    And I wait "/project_one/ekpo" Async Queue complete

    Given I import "/project_one/ekbe" by keyFields "belnr,buzei,ebeln,ebelp,gjahr,mandt,vgabe,zekkn"
    | mandt |   ebeln    | ebelp | zekkn | vgabe| gjahr |   belnr    | buzei | bewtp | bwart |   budat  |   menge   |
    |  120  | 3000793997 |	10   |	0    |	1   | 2017  | 5006382844  |  1    |   E  |	101   |	20170103 |	1968.000 |
    |  120  | 3000793997 |	10   |	0    |	2   | 2017  | 5115285205  |  1    |   Q  |	 	  | 20170116 |	1968.000 |
    |  120  | 3000793997 |	10   |	0    |	6   | 2017  | 4928400506  |  1    |   U  |	643   |	20170109 |	1968.000 |
    |  120  | 3000793997 |	10   |	0    |	8   | 	    | 196625892	  |  10   |   L	  |   	  | 20170109 |	0.000    |
    |  120  | 3000793997 |	10   |	0    |	8   | 1990  | 196625892	  |  1    |	  L	 |	      | 20170109 |	1968.000 |
    |  120  | 3000793997 |	20   |	0    |	1   | 2017  | 5006382844  |  2	  |   E	 |  101   |	20170103 |	10344.000|
    |  120  | 3000793997 |	20   |	0    |	2   | 2017  | 5115285205  |  2	  |   Q	 |	      | 20170116 |	10344.000|
    |  120  | 3000793997 |	20   |	0    |	6   | 2017  | 4928400506  |  2	  |   U	 |  643   |	20170109 |	10344.000|
    |  120  | 3000793997 |	20   |	0    |	8   | 	    | 196625892	  |  20   |   L  |	 	  | 20170109 |	0.000    |
    |  120  | 3000793997 |	20   |	0    |	8   | 1990  | 196625892	  |  4    |   L  |	 	  | 20170109 |	10344.000|
    |  120  | 3000793997 |	30   |	0    |	1   | 2017  | 5006382844  |  3    |   E  |	101   |	20170103 |	11124.000|
    |  120  | 3000793997 |	30   |	0    |	1   | 2017  | 5006382844  |  4    |   E  |	101   |	20170103 |	1524.000 |
    |  120  | 3000793997 |	30   |	0    |	2   | 2017  | 5115285205  |  3    |   Q  |	 	  | 20170116 |	12648.000|
    |  120  | 3000793997 |	30   |	0    |	6   | 2017  | 4928400506  |  3    |   U  |	643   |	20170109 |	11124.000|
    |  120  | 3000793997 |	30   |	0    |	6   | 2017  | 4928400506  |  4    |   U  |	643   |	20170109 |	1524.000 |
    |  120  | 3000793997 |	30   |	0    |	8   | 	    | 196625892	  |  30   |   L  |	 	  | 20170109 |	0.000    |
    |  120  | 3000793997 |	30   |	0    |	8   | 1990  | 196625892	  |  5    |   L  |	 	  | 20170109 |	11124.000|
    |  120  | 3000793997 |	30   |	0    |	8   | 1990  | 196625892	  |  6    |   L  |	 	  | 20170109 |	1524.000 |
    |  120  | 3000793997 |	40   |	0    |	1   | 2017  | 5006382844  |  5	  |   E	 |  101   |	20170103 |	11136.000|
    |  120  | 3000793997 |	40   |	0    |	2   | 2017  | 5115285206  |  4    |	  Q  |	 	  | 20170116 |	11136.000|
    |  120  | 3000793997 |	40   |	0    |	6   | 2017  | 4928400719  |  1    |	  U  |	643   |	20170109 |	11136.000|
    |  120  | 3000793997 |	40   |	0    |	8   | 	    | 196625893   |	 10   |   L	 |   	  | 20170109 |	0.000    |
    |  120  | 3000793997 |	40   |	0    |	8   | 1990  | 196625893   |	 1    |   L	 |     	  | 20170109 |	11136.000|
    |  120  | 3000793997 |	50   |	0    |	1   | 2017  | 5006382844  |  6    |   E  | 101   | 	20170103 |	1872.000 |
    |  120  | 3000793997 |	50   |	0    |	1   | 2017  | 5006382844  |  7    |   E  | 101   | 	20170103 |	2088.000 |
    |  120  | 3000793997 |	50   |	0    |	1   | 2017  | 5006382844  |  8    |   E  | 101   | 	20170103 |	252.000  |
    |  120  | 3000793997 |	50   |	0    |	2   | 2017  | 5115285205  |  5    |   Q  |       | 	20170116 |	4212.000 |
    |  120  | 3000793997 |	50   |	0    |	6   | 2017  | 4928400506  |  5    |   U  | 643   | 	20170109 |	1872.000 |
    |  120  | 3000793997 |	50   |	0    |	6   | 2017  | 4928400506  |  6    |   U  | 643   | 	20170109 |	2088.000 |
    |  120  | 3000793997 |	50   |	0    |	6   | 2017  | 4928400506  |  7    |   U  | 643   | 	20170109 |	252.000  |
    |  120  | 3000793997 |	50   |	0    |	8   | 	    | 196625892	  |  40   |   L	 |	     |  20170109 |	0.000    |
    |  120  | 3000793997 |	50   |	0    |	8   | 1990  | 196625892	  |  7    |   L	 |	     |  20170109 |	1872.000 |
    |  120  | 3000793997 |	50   |	0    |	8   | 1990  | 196625892	  |  8    |   L	 |	     |  20170109 | 	2088.000 |
    |  120  | 3000793997 |	50   |	0    |	8   | 1990  | 196625892	  |  9    |   L	 |	     |  20170109 |	252.000  |
    |  120  | 3000793997 |	60   |	0    |	1   | 2017  | 5006382844  |  9    |   E  | 101  |	20170103 |	1968.000 |
    |  120  | 3000793997 |	60   |	0    |	2   | 2017  | 5115285208  |  6    |   Q  |      |	20170116 |	1968.000 |
    |  120  | 3000793997 |	60   |	0    |	6   | 2017  | 4928408767  |  1    |   U  | 643  |	20170110 |	1968.000 |
    |  120  | 3000793997 |	60   |	0    |	8   | 	    | 196628431   |  10   |   L	 |  	 |  20170110 |	0.000    |
    |  120  | 3000793997 |	60   |	0    |	8   | 1990  | 196628431   |  1    |   L	 |  	 |  20170110 |	1968.000 |
    |  120  | 3000793997 |	70   |	0    |	1   | 2017  | 5006382844  |  10   |	  E	 |  101	 |  20170103 |	5520.000 |
    |  120  | 3000793997 |	70   |	0    |	2   | 2017  | 5115285205  |  7    |	  Q	 |  	 |  20170116 |	5520.000 |
    |  120  | 3000793997 |	70   |	0    |	6   | 2017  | 4928400506  |  8    |	  U	 |  643	 |  20170109 |	5520.000 |
    |  120  | 3000793997 |	70   |	0    |	8   | 	    | 196625892   |  50   |   L	 |  	 |  20170109 |	0.000    |
    |  120  | 3000793997 |	70   |	0    |	8   | 1990  | 196625892   |  10   |   L	 |  	 |  20170109 |	5520.000 |
    |  120  | 3000793997 |	80   |	0    |	1   | 2017  | 5006382844  |  11   |	  E	 |  101	 |  20170103 |	1080.000 |
    |  120  | 3000793997 |	80   |	0    |	1   | 2017  | 5006382844  |  12   |	  E	 |  101	 |  20170103 |	2184.000 |
    |  120  | 3000793997 |	80   |	0    |	2   | 2017  | 5115285207  |  8    |	  Q	 |  	 |  20170116 |	3264.000 |
    |  120  | 3000793997 |	80   |	0    |	6   | 2017  | 4928400720  |  1    |   U  |	643	 |  20170109 |	1080.000 |
    |  120  | 3000793997 |	80   |	0    |	6   | 2017  | 4928400720  |  2    |	  U  |	643	 |  20170109 |	2184.000 |
    |  120  | 3000793997 |	80   |	0    |	8   | 	    | 196625894   |	 10   |   L	 |       |	20170109 |	0.000    |
    |  120  | 3000793997 |	80   |	0    |	8   | 1990  | 196625894   |	 1    |   L	 |       |	20170109 |	1080.000 |
    |  120  | 3000793997 |	80   |	0    |	8   | 1990  | 196625894   |	 2    |   L	 |       |	20170109 |	2184.000 |
    |  120  | 3000794007 |	10   |	0    |	1   | 2017  | 5006382696  |  1    |   E |	101	 |  20170103 |	11472.000|
    |  120  | 3000794007 |	10   |	0    |	1   | 2017  | 5006382696  |  2    |   E |	101  |  20170103 |	16680.000|
    |  120  | 3000794007 |	10   |	0    |	2   | 2017  | 5115285204  |  1    |   Q |		 |  20170116 |	28152.000|
    |  120  | 3000794007 |	10   |	0    |	6   | 2017  | 4928400505  |  1    |   U |	643	 |  20170109 |	11472.000|
    |  120  | 3000794007 |	10   |	0    |	6   | 2017  | 4928400505  |  2    |   U |	643	 |  20170109 |	16680.000|
    |  120  | 3000794007 |	10   |	0    |	8   | 	    | 196625891	  |  10   |   L |		 |  20170109 |	0.000    |
    |  120  | 3000794007 |	10   |	0    |	8   | 1990  | 196625891	  |  1    |   L	|	     |  20170109 |	11472.000|
    |  120  | 3000794007 |	10   |	0    |	8   | 1990  | 196625891	  |  2    |   L	|        |	20170109 |	16680.000|
    |  120  | 3000794023 |	10   |	0    |	1   | 2017  | 5006387284  |  1    |   E | 	101	 |  20170106 |	8172.000 |
    |  120  | 3000794023 |	10   |	0    |	1   | 2017  | 5006387284  |  2    |   E | 	101	 |  20170106 |	23880.000|
    |  120  | 3000794023 |	10   |	0    |	1   | 2017  | 5006387284  |  3    |   E | 	101	 |  20170106 |	7788.000 |
    |  120  | 3000794023 |	10   |	0    |	2   | 2017  | 5115285219  |  1    |   Q | 		 |  20170116 |	39840.000|
    |  120  | 3000794023 |	10   |	0    |	6   | 2017  | 4928409994  |  1    |   U | 	643	 |  20170110 |	8172.000 |
    |  120  | 3000794023 |	10   |	0    |	6   | 2017  | 4928409994  |  2    |   U | 	643	 |  20170110 |	7788.000 |
    |  120  | 3000794023 |	10   |	0    |	6   | 2017  | 4928409994  |  3    |   U | 	643	 |  20170110 |	23880.000|
    |  120  | 3000794023 |	10   |	0    |	8   | 	    | 196628443	  |  10   |   L	|	     |  20170110 |	0.000    |
    |  120  | 3000794023 |	10   |	0    |	8   | 1990  | 196628443	  |  1    |   L	|	     |  20170110 |	8172.000 |
    |  120  | 3000794023 |	10   |	0    |	8   | 1990  | 196628443	  |  2    |   L	|	     |  20170110 |	7788.000 |
    |  120  | 3000794023 |	10   |	0    |	8   | 1990  | 196628443	  |  3    |   L	|	     |  20170110 |	23880.000|


    And I wait "/project_one/ekbe" Async Queue complete

    Given I import "/project_one/ekes" by keyFields "ebeln,ebelp,etens,mandt"
    | charg      | dabmg |    ebeln   | ebelp | ebtyp |   eindt  | ematn |   erdat | estkz | etens | ezeit | imwrk | kzdis | loekz | lpein | mahnz | mandt | menge | mprof | refEtens | uecha | uzeit | vbeln | vbelp |   xblnr  |
    | 4001127722 |   1   | 3000793997 |   10  |  LA   | 20111205 |       | 20111021|   1   |   1   | 73744 |       |   X   |       |   1   |   0   |  120  |   1   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    | 4001127723 |  17   | 3000793997 |   20  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74015 |       |   X   |       |   1   |   0   |  120  |  17   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    | 4001127724 |   6   | 3000793997 |   30  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74027 |       |   X   |       |   1   |   0   |  120  |   6   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    | 4001127725 |   1   | 3000793997 |   40  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74103 |       |   X   |       |   1   |   0   |  120  |   1   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    | 4001127726 |   3   | 3000793997 |   50  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74226 |       |   X   |       |   1   |   0   |  120  |   3   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    | 4001127727 |   4   | 3000793997 |   60  |  LA   | 20111205 |       | 20111021|   1   |   1   | 73854 |       |   X   |       |   1   |   0   |  120  |   4   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    | 4001127728 |   2   | 3000793997 |   70  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74018 |       |   X   |       |   1   |   0   |  120  |   2   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    |            |   2   | 3000793997 |   80  |  LA   | 20111205 |       | 20111021|   1   |   1   | 73843 |       |   X   |       |   1   |   0   |  120  |   2   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    |            |   3   | 3000794007 |   10  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74146 |       |   X   |       |   1   |   0   |  120  |   3   |       |    0     |  0    |   0   |       |  0    | 18102011 |
    |            |   9   | 3000794023 |   10  |  LA   | 20111205 |       | 20111021|   1   |   1   | 74006 |       |   X   |       |   1   |   0   |  120  |   9   |       |    0     |  0    |   0   |       |  0    | 18102011 |

    And I wait "/project_one/ekes" Async Queue complete

    Given I import "/project_one/eket" by keyFields "ebeln,ebelp,mandt"
    | mandt |    ebeln   | ebelp | etenr |   eindt  |   menge   |   wemng   |   banfn    | bnfpo |   glmng   | dabmg  |
    |  120  | 3000793997 |   10  |  1    | 20170106 | 1968.000  | 1968.000  | 1603571115 |   10  | 1968.000  |  0.000 |
    |  120  | 3000793997 |   20  |  1    | 20170106 | 10344.000 | 10344.000 | 1603563155 |   10  | 10344.000 |  0.000 |
    |  120  | 3000793997 |   30  |  1    | 20170106 | 12648.000 | 12648.000 | 1603559777 |   10  | 12648.000 |  0.000 |
    |  120  | 3000793997 |   40  |  1    | 20170106 | 11136.000 | 11136.000 | 1603568088 |   10  | 11136.000 |  0.000 |
    |  120  | 3000793997 |   50  |  1    | 20170106 | 4212.000  | 4212.000  | 1603560676 |   10  | 4212.000  |  0.000 |
    |  120  | 3000793997 |   60  |  1    | 20170106 | 1968.000  | 1968.000  | 1603555121 |   10  | 1968.000  |  0.000 |
    |  120  | 3000793997 |   70  |  1    | 20170106 | 5520.000  | 5520.000  | 1603559477 |   10  | 5520.000  |  0.000 |
    |  120  | 3000793997 |   80  |  1    | 20170106 | 3264.000  | 3264.000  | 1603557667 |   10  | 3264.000  |  0.000 |
    |  120  | 3000794007 |   10  |  1    | 20170106 | 28152.000 | 28152.000 | 1603559859 |   10  | 28152.000 |  0.000 |
    |  120  | 3000794023 |   10  |  1    | 20170106 | 39840.000 | 39840.000 | 1603563584 |   10  | 39840.000 |  0.000 |

    And I wait "/project_one/eket" Async Queue complete

    Given I import "/project_one/ekpv" by keyFields "ebeln,ebelp,mandt"
    | kunnr  |    ebeln   | ebelp | mandt |
    | 157377 | 3000793997 |   10  |  120  |
    | 157377 | 3000793997 |   20  |  120  |
    | 157377 | 3000793997 |   30  |  120  |
    | 157377 | 3000793997 |   40  |  120  |
    | 157377 | 3000793997 |   50  |  120  |
    | 157377 | 3000793997 |   60  |  120  |
    | 157377 | 3000793997 |   70  |  120  |
    | 157377 | 3000793997 |   80  |  120  |
    | 109519 | 3000794007 |   10  |  120  |
    | 109525 | 3000794023 |   10  |  120  |

    And I wait "/project_one/ekpv" Async Queue complete

    Given I import "/edm/source_system_v1" by keyFields "sourceSystem,localSourceSystem"
    | sourceSystem  |    localSourceSystem   |
    | project_one   |       Project_One      |

    And I wait "/edm/source_system_v1" Async Queue complete


    When I submit task with xml file "xml/edm/EDMPurchaseOrderOA.xml" and execute file "jar/pangea-view.jar"

    Then I check region data "/edm/purchase_order_oa_v1" by keyFields "sourceSystem,poNum,poLineNbr,evTypeCd,matlMvmttYr,matlMvmtNum,matlMvmtSeqNbr,delvSchedCntNbr"
    | sourceSystem | poNum | poLineNbr | evTypeCd | matlMvmttYr | matlMvmtNum | matlMvmtSeqNbr | delvSchedCntNbr | poCatTypeCd | poTypeCd | crtOnDt | supNum | prchsngOrgNum | prchsngGrpNum | prchsngCoCd | crncyCd | poDt | vldFromDt | vldToDt | suplVendNum | suplPlntCd | rlseCmpltInd | rlseDocInd | delInd | matlNum | plntCd | slocCd | intrnlRefNum | poLineQty | poUomCd | localNumerator | localDenominator | stkTypeCd | delvCmpltInd | lineItemTypeCd | acctAsgnmtCatCd | prinPrchAgmtNum | prinPrchAgmtLineNbr | localBaseUOM | delvAddrNum | localPDT | localSpecialStock | cnfrmCd | subcntrcInd | localdelvAddrNum | prDocId | prLineNbr | localBrazilianNCMCode | isuSlocCd | poHistCatCd | localMovementType | localPostingDate | recvEaQty | cnfrmSeqNbr | delvDt | crtOnDt | cnfrmQty | mrpAdjQty | localCreationIndVendorConf | slsOrdrNum | slsOrdrLineNbr | vendBtchNum | localdelvDt | schdQty | recvQty | localPurchaseReq | localPurchaseReqItem | stkTfrRecvQty | localmrpAdjQty | grLeadTimeDays | custNum |


    And I will remove all data with region "/project_one/ekpo"

    And I will remove all data with region "/project_one/ekko"

    And I will remove all data with region "/project_one/ekbe"

    And I will remove all data with region "/project_one/ekes"

    And I will remove all data with region "/project_one/eket"

    And I will remove all data with region "/project_one/ekpv"

    And I will remove all data with region "/edm/purchase_order_oa_v1"

